<html><!DOCTYPE html> 
<html lang="en"> 
<head> 

	<meta charset="utf-8">
  	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>SSI Modifica Programmi</title>
	<link rel="stylesheet" href="css/jquery-ui.min.css">
	<script src="javascript/jquery.js"></script>
	<script src="javascript/jquery-ui.min.js"></script>
	<link href="https://fonts.googleapis.com/css?family=Comfortaa" rel="stylesheet">

	<meta id="viewport" name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />	
	
    <script type="text/javascript">
     $(document).ready(function() {		
		$.ajaxSetup( { cache: false } );
		//importo la variabile 
		var stringUrl = window.location.search;
		stringUrl = stringUrl.substring(1);
			$.getJSON(stringUrl, function(jd) {
				console.log (jd);
				
				document.getElementById ("programma").value = jd.Programma;
				document.getElementById ("orainizio").value = jd.Inizio;
				document.getElementById ("orafine").value = jd.Fine;
				
       
					if (jd.TuttiGiorni == 1) {
					  document.getElementById("tuttigiorni").checked="checked";
					  /* on deselect di tuttigiorni si devono riattivare - implementare javascript
					  *
					  document.getElementById("lun").disabled="disabled";
					  document.getElementById("mar").disabled="disabled";
					  document.getElementById("mer").disabled="disabled";
					  document.getElementById("gio").disabled="disabled";
					  document.getElementById("ven").disabled="disabled";
					  document.getElementById("sab").disabled="disabled";
					  document.getElementById("dom").disabled="disabled";
					  *
					  */
					}
					else
					{
    					if (jd.Lunedi == 1) 
    					document.getElementById("lun").checked="checked";
    					if (jd.Martedi == 1) 
    					document.getElementById("mar").checked="checked";
    					if (jd.Mercoledi == 1) 
    					document.getElementById("mer").checked="checked";
    					if (jd.Giovedi == 1) 
    					document.getElementById("gio").checked="checked";
    					if (jd.Venerdi == 1) 
    					document.getElementById("ven").checked="checked";
    					if (jd.Sabato == 1) 
    					document.getElementById("sab").checked="checked";
    					if (jd.Domenica == 1) 
    					document.getElementById("dom").checked="checked";
					}
        if (jd.TutteValvole == 1) {
					document.getElementById("tuttevalvole").checked="checked";
					/* on deselect di tuttevalvole si devono riattivare - implementare javascript
					  *
					  document.getElementById("valvola1").disabled="disabled";
					  document.getElementById("valvola2").disabled="disabled";
					  document.getElementById("valvola3").disabled="disabled";
					  document.getElementById("valvola4").disabled="disabled";
					  document.getElementById("valvola5").disabled="disabled";
					  document.getElementById("valvola6").disabled="disabled";
					  document.getElementById("valvola7").disabled="disabled";
					  document.getElementById("valvola8").disabled="disabled";
					  *
					  */
				}
				else{
					if (jd.Valvola1 == 1) 
					document.getElementById("valvola1").checked="checked";
					if (jd.Valvola2 == 1) 
					document.getElementById("valvola2").checked="checked";
					if (jd.Valvola3 == 1) 
					document.getElementById("valvola3").checked="checked";
					if (jd.Valvola4 == 1) 
					document.getElementById("valvola4").checked="checked";
          if (jd.Valvola5 == 1) 
					document.getElementById("valvola5").checked="checked";
					if (jd.Valvola6 == 1) 
					document.getElementById("valvola6").checked="checked";
					if (jd.Valvola7 == 1) 
					document.getElementById("valvola7").checked="checked";
					if (jd.Valvola8 == 1) 
					document.getElementById("valvola8").checked="checked";
				}
        
        if (jd.Attivo == 1) {
						document.getElementById("programmaattivosi").checked="checked";
				}
				else{
					document.getElementById("programmaattivono").checked="checked";
				}
			});
		});
		
		//salvataggio
		function saveProgramma(){
		// variabile per salvare
		sched_json="";
		//mettiamo a zero tutto
		Programma=0;
		Attivo=0;
		Inizio=0;
		Fine=0;
		TuttiGiorni=0;
		Lunedi=0;
		Martedi=0;
		Mercoledi=0;
		Giovedi=0;
		Venerdi=0;
		Sabato=0;
		Domenica=0;
		TutteValvole=0;
		Valvola1=0;
		Valvola2=0;
		Valvola3=0;
		Valvola4=0;
		Valvola5=0;
		Valvola6=0;
		Valvola7=0;
		Valvola8=0;
		// Assegnamo i dati 
		Programma=document.getElementById("programma").value;

		if(document.getElementById("programmaattivosi").checked){
			Attivo=1;
		}
		else
		{
			Attivo=0;
		}
		Inizio=document.getElementById("orainizio").value;
		Fine=document.getElementById("orafine").value;
		
		if(document.getElementById("tuttigiorni").checked){
			TuttiGiorni=1;
			}
		if(document.getElementById("lun").checked){
			Lunedi=1;
			}
		if(document.getElementById("mar").checked){
			Martedi=1;
			}
		if(document.getElementById("mer").checked){
			Mercoledi=1;
		}
		if(document.getElementById("gio").checked){
			Giovedi=1;
			}
		if(document.getElementById("ven").checked){
			Venerdi=1;
			}
		if(document.getElementById("sab").checked){
			Sabato=1;
		}
		if(document.getElementById("dom").checked){
			Domenica=1;
		}
		if(document.getElementById("tuttevalvole").checked){
			TutteValvole=1;
			}
		if(document.getElementById("valvola1").checked){
			Valvola1=1;
			}
		if(document.getElementById("valvola2").checked){
			Valvola2=1;
			}
		if(document.getElementById("valvola3").checked){
			Valvola3=1;
		}
		if(document.getElementById("valvola4").checked){
			Valvola4=1;
			}
		if(document.getElementById("valvola5").checked){
			Valvola5=1;
			}
		if(document.getElementById("valvola6").checked){
			Valvola6=1;
		}
		if(document.getElementById("valvola7").checked){
			Valvola7=1;
		}
		if(document.getElementById("valvola8").checked){
			Valvola8=1;
		}
		sched_json="{ \"Programma\": \""+Programma+"\" , \"Attivo\": "+Attivo+",\"Inizio\": \""+Inizio+"\"  ,\"Fine\": \""+Fine+"\" , \"TuttiGiorni\": "+TuttiGiorni+", \"Lunedi\": "+Lunedi+",\"Martedi\": "+Martedi+" , \"Mercoledi\": "+Mercoledi+",\"Giovedi\": "+Giovedi+"  ,\"Venerdi\": "+Venerdi+" , \"Sabato\": "+Sabato+", \"Domenica\": "+Domenica+",\"TutteValvole\": "+TutteValvole+" , \"Valvola1\": "+Valvola1+",\"Valvola2\": "+Valvola2+"  ,\"Valvola3\": "+Valvola3+" , \"Valvola4\": "+Valvola4+", \"Valvola5\": "+Valvola5+", \"Valvola6\": "+Valvola6+" , \"Valvola7\": "+Valvola7+",\"Valvola8\": "+Valvola8+"}\n";
		console.log(sched_json);
				
		//salviamo m andando in POST
		$.ajax( "programmod", {
			data: sched_json,
			contentType: 'application/json',
			async: false,
			type : 'POST', 
			success: function( html ) {
				window.document.write( html );
				}		
		});
		//window.location.reload();
	 }
      </script>
      
      <style>
  		input[type="submit"] {
   		border: 0 !important;  /*Removes border*/
   		-webkit-appearance: none;  /*Removes default chrome and safari style*/
   		-moz-appearance: none; /* Removes Default Firefox style*/
        /*background-color: #0088cc /*url(img/select-arrow.png) no-repeat 90% center;*/
        width: 100px; /*Width of select dropdown to give space for arrow image*/
        height:30px;
		    text-indent: 0.01px; /* Removes default arrow from firefox*/
        text-overflow: "";  /*Removes default arrow from firefox*/ /*My custom style for fonts*/
        color: #000;
        border-radius: 15px;
        padding: 1px;
        box-shadow: inset 0 0 5px rgba(000,000,000, 1);
  		background-color:rgba(21,199,238,1); /* colore di sfondo    testo    */
  		font-family: 'Comfortaa', cursive;
  		font-size:0.8em;
  		font-weight: bold;         /* testo in grassetto  */
  		}
      </style>
   </head>
   
   <body>

  <p style = "margin: auto; text-align: center; width: 950px; font-family: 'Segoe UI'; font-size: 20pt; font-weight: bold; color: rgba(21,199,238,1); background-color: white">SSI Modifica Programma </p>
  <br>        

	<table width="950" border="0" align="center" cellpadding="0" cellspacing="10" style="font-family: 'Comfortaa'">
	  <tr>
	    <td width="25%" class="inserimento" >Nome Programma:</td>
	    <td colspan="3" align="left"><label for="programma"></label>
        <input name="programma" type="text" class="nomeprogramma" id="programma" size="100" maxlength="100"></td>
      </tr>
	  <tr>
	    <td class="inserimento">Inizio Irrigazione:</td>
	    <td width="18%" align="left"><input name="orainizio" type="time" class="orario"  id="orainizio" ></td>
	    <td width="18%" align="left" class="aaa"><span class="inserimento">Fine Irrigazione:</span></td>
	    <td width="39%" align="left"><input name="orafine" type="time" class="orario" id="orafine"></td>
      </tr>
	  <tr class="inserimento">
	    <td class="inserimento">Giorni :</td>
	    <td colspan="3" align="left">
          <table width="101%" border="0">
            <tr>
              <td><p>
                <INPUT TYPE="checkbox" NAME="tuttigiorni" class="checkbox" value="off" style="font-family:Comfortaa;" id="tuttigiorni">Tutti
                <INPUT TYPE="checkbox" NAME="lun" class="checkbox" value="off" style="font-family:Comfortaa;" id="lun">Lunedi
                <INPUT TYPE="checkbox" NAME="mar" class="checkbox" value="off" style="font-family:Comfortaa;" id="mar">Martedi
                <INPUT TYPE="checkbox" NAME="mer" class="checkbox" value="off" style="font-family:Comfortaa;" id="mer">Mercoledi
                <INPUT TYPE="checkbox" NAME="gio" class="checkbox" value="off" style="font-family:Comfortaa;" id="gio">Giovedi
                <INPUT TYPE="checkbox" NAME="ven" class="checkbox" value="off" style="font-family:Comfortaa;" id="ven">Venerdi
                <INPUT TYPE="checkbox" NAME="sab" class="checkbox" value="off" style="font-family:Comfortaa;" id="sab">Sabato
                <INPUT TYPE="checkbox" NAME="dom" class="checkbox" value="off" style="font-family:Comfortaa;" id="dom">Domen.
              </p></td>
            </tr>
        </table></td>
      </tr>
	  <tr>
	    <td class="inserimento">Valvole:</td>
	    <td colspan="3" align="left"><table width="101%" border="0">
	      <tr>
	        <td><p>
	          <INPUT TYPE="checkbox" NAME="tuttevalvole" class="checkbox" id="tuttevalvole">Tutte
	          <INPUT TYPE="checkbox" NAME="valvola1" class="checkbox" VALUE="off" id="valvola1">1
	          <INPUT TYPE="checkbox" NAME="valvola2" class="checkbox" VALUE="off" id="valvola2">2
	          <INPUT TYPE="checkbox" NAME="valvola3" class="checkbox" VALUE="off" id="valvola3">3
	          <INPUT TYPE="checkbox" NAME="valvola4" class="checkbox" VALUE="off" id="valvola4">4 
	          <INPUT TYPE="checkbox" NAME="valvola5" VALUE="off" id="valvola5">5 
	          <INPUT TYPE="checkbox" NAME="valvola6" VALUE="off" id="valvola6">6 
	          <INPUT TYPE="checkbox" NAME="valvola7" VALUE="off" id="valvola7">7 
	          <INPUT TYPE="checkbox" NAME="valvola8" VALUE="off" id="valvola8">8
	          </p></td>
          </tr>
	      </table></td>
      </tr>
	  <tr>
	    <td class="inserimento">Attivo:</td>
	    <td colspan="3" align="left"><p>
          <label>
          <input type="radio" name="programmaattivo" value="off" id="programmaattivosi">Si
          </label>
          <label>
          <input type="radio" name="programmaattivo" value="off" id="programmaattivono">No
          </label>
          <br>
        </p></td>
      </tr>
    
    </table>
	  <div align="center" style = " width:950px; background-position:center; margin:0 auto;" >
		<p></p>
		<input type="submit" value="Cancel" onclick="window.location = './index.htm';" /				>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		
		<input type="submit" value="Salva" onclick="saveProgramma();" />
		<p></p>
       </div>
   </form> 
       
       

       
       
</body>
	
</html>

